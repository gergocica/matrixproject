<!DOCTYPE html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

 <style>

* { margin: 0;
   box-sizing: border-box
  } 

.legend, .legend2 
{ position:relative; width:830px; margin-left:auto; margin-right:auto; padding:3px 4px 5px 6px; background-color:azure; color:black; 
  font-family: 'Inter', sans-serif; font-size:14px; border: 1px solid green  }

.legend { top:4px; z-index:+2 }
.legend2 { top:-90px; z-index:+1 }

.span1 { background-color:OldLace }
.span2 { background-color:Beige }

.frame
{ position:relative; top:-28px; width:830px; margin-left:auto; margin-right:auto; border:0 }

.input
  { position:relative; top:-100px; margin:20px auto; max-width:700px; text-align:center; 
  font-family: 'Inter', sans-serif; font-size:14px; font-weight:bold }

  @media only screen and (max-width: 500px) { 
.legend, .legend2 
{ width:100%;
}

 </style>
</head> 
<body>

<div class="legend">
<span class="span1"><strong>IN:</strong>&nbsp;Initials&nbsp;</span>
<span class="span2"><strong>Last Pay:</strong>&nbsp;Last payment date&nbsp;</span>
<span class="span1"><strong>Sp:</strong>&nbsp;Sponsored by&nbsp;</span> 
<span class="span2"><strong>A?:</strong>&nbsp;Id is active?&nbsp;</span>
<span class="span1"><strong>PS:</strong>&nbsp;Pos. under sponsor&nbsp;</span>
<span class="span2"><strong>GL:</strong>&nbsp;Global level&nbsp;</span>
<span class="span1"><strong>L1:</strong>&nbsp;No. of referrals on L1&nbsp;</span> 
<span class="span2"><strong>L3:</strong>&nbsp;No. of IDs on L3&nbsp;</span>
<span class="span1"><strong>DL:</strong>&nbsp;Total no. of downline IDs&nbsp;</span>
<span class="span2"><strong>$M:</strong>&nbsp;Maximum payout after ... IDs&nbsp;</span>
<span class="span1"><strong>$R:</strong>&nbsp;Real payout after ... IDs&nbsp;</span>
<span class="span2"><strong>L?:</strong>&nbsp;Days left until inactive&nbsp;</span>
<span class="span1"><strong>I?:</strong>&nbsp;Days since inactive&nbsp;</span>
<span class="span2"><strong>üî≤:</strong>&nbsp;All active ID-s on L3&nbsp;</span>
</div>

<div class="frame" style="z-index:+1">
<iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRSSzQsM6izXxxxQNCQCXCnbWwQLid-GFLZSel39SnElJo6ZwK1fywqBE9Y7IukwcxVsmNlEvDETrwQ/pubhtml?gid=1414948812&amp;single=true&amp;widget=true&amp;headers=false&rm=minimal"
style="height:54px; width:100%">
</iframe>
</div>

<div class="frame">
    <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRSSzQsM6izXxxxQNCQCXCnbWwQLid-GFLZSel39SnElJo6ZwK1fywqBE9Y7IukwcxVsmNlEvDETrwQ/pubhtml?gid=900266326&range=A3:T1000&single=true&widget=true&headers=false&rm=minimal"
      style="position:relative; top:-32px; height:499px; width:100%">
    </iframe>
  </div>

<div class="legend2">
Use a device with a screen width of at least 830 pixels for the best viewing experience.<br>
If using a phone to view a üî≤ link, hold your phone in a horizontal position (landscape view).
</div>

<div class="input">
  üîç Lookup Full Data for an ID<br>
  <input id="idInput" type="number" min="1" placeholder="Enter ID" style="margin-top: 6px; width:80px; padding: 4px 4px; font-size: 14px;">
  <button onclick="fetchRow()" style="margin-top: 6px; padding: 4px 8px; font-family: 'Inter', sans-serif; font-size: 14px;">Show Data</button>
  <div id="rowOutput" style="margin-top: 20px;"></div>
</div>

<script>
  const scriptURL = "https://script.google.com/macros/s/AKfycbz7xy_6Iyh8LFs3WgKOJ8dt78q3Zn1uJOKhM4xz_D3TcGB2J3D7jSFCPX9vmvvC8sjK/exec";

  async function fetchRow() {
    const id = document.getElementById('idInput').value.trim();
    if (!id) return;

    try {
      const response = await fetch(`${scriptURL}?mode=json&row=${parseInt(id) + 2}`);
      const data = await response.json();

      // 1Ô∏è‚É£ Header map
      const headerMap = {
        "IN": "Initials",
        "Join Date": "Join Date",
        "Last Pay": "Last Payment Date",
        "Sp": "Sponsored by",
        "A?": "ID is Active?",
        "PS": "Pos. under sponsor",
        "GL": "Global level",
        "L1": "No. of referrals on L1",
        "L3": "No. of IDs on L3",
        "DL": "Total no. of downline IDs",
        "Placement path": "Placement Path",
        "$M": "Maximum payout after ... IDs",
        "$R": "Real payout after ... IDs",
        "Active L1-s": "Active L1 IDs",
        "Active L3-s": "Active L3 IDs",
        "L?": "Days left until inactive",
        "I?": "Days since inactive"
      };

      // 2Ô∏è‚É£ Date formatter for both date columns
      function formatDate(value) {
        if (!value) return value;
        const date = new Date(value);
        if (isNaN(date)) return value; // leave unchanged if not a valid date
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        const year = date.getFullYear();
        return `${month}/${day}/${year}`;
      }

      const dateColumns = ["Join Date", "Last Pay"];

      // 3Ô∏è‚É£ Big screen layout
      const bigscreenHtml = `
        <div style="background:#f9f9f9; padding:8px; border:1px solid #ccc; border-radius:8px;">
          <h4 style="margin-top:0; margin-bottom:2px">ID ${id}</h4>
          <table style="width:100%; border-collapse:separate">
            ${data.headers.map((header, i) => {
              const label = headerMap[header] || header;
              let value = (header === "Active L3-s" && data.fullL3) ? data.fullL3 : data.values[i];
              if (dateColumns.includes(header)) value = formatDate(value);
              return `
                <tr style="font-weight:bold">
                  <td style="width:220px; padding:4px; background-color:green; border:1px solid #ddd; color:white">${label}</td>
                  <td style="padding:4px; background-color:azure; border:1px solid #ddd;">${value}</td>
                </tr>`;
            }).join('')}
          </table>
        </div>`;

      // 4Ô∏è‚É£ Small screen layout
      const smallscreenHtml = `
        <div style="max-width:398px; margin:auto; background:#f9f9f9; padding:5px 1px; border:1px solid #ccc; border-radius:6px;">
          <h4 style="margin-top:0; margin-bottom:2px">ID ${id}</h4>
          <table style="width:100%; border-collapse:collapse;">
            ${data.headers.map((header, i) => {
              const label = headerMap[header] || header;
              let value = (header === "Active L3-s" && data.fullL3) ? data.fullL3 : data.values[i];
              if (dateColumns.includes(header)) value = formatDate(value);
              return `
                <tr style="font-weight:normal">
                  <td style="width:40%; padding:4px; background-color:green; border:1px solid #ddd; color:white">${label}</td>
                  <td style="padding:4px; background-color:azure; border:1px solid #ddd;">${value}</td>
                </tr>`;
            }).join('')}
          </table>
        </div>`;

      // 5Ô∏è‚É£ Responsive render
      const isMobile = window.innerWidth <= 400;
      document.getElementById("rowOutput").innerHTML = isMobile ? smallscreenHtml : bigscreenHtml;

    } catch (err) {
      document.getElementById("rowOutput").innerHTML =
        `<div style="color:red;">‚ùå Error: Could not fetch data for ID "${id}".</div>`;
      console.error(err);
    }
  }
</script>

</body>
</html>                           
