<!DOCTYPE html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<link rel="stylesheet" href="https://rsms.me/inter/inter.css">

<style>

* {box-sizing: border-box} 

.legend, .legend2 
{ position:relative; width:840px; margin-left:auto; margin-right:auto; padding:3px 4px 5px 6px; background-color:azure; color:black; 
  font-family: 'Inter', sans-serif; font-size:14px; border: 1px solid green  }

.legend { top:4px; z-index:+2 }

.legend2 { top:-134px; z-index:+1 }

.frame
{ position:relative; top:-28px; width:840px; margin-left:auto; margin-right:auto; border:0 }

</style>
 </head> 

<body>

<div class="legend">
<strong>Sp:</strong> Sponsored by / <strong>IN:</strong> Initials / <strong>Last Pay:</strong> Last payment date / <strong>A?:</strong> Id is active? / 
<strong>PS:</strong> Pos. under sponsor / <strong>GL:</strong> Global level /<br> 
<strong>L1:</strong> No. of referrals on L1 / <strong>L3:</strong> No. of IDs on L3 / <strong>DL:</strong> Total no. of downline IDs / 
<strong>$M:</strong> Maximum payout / <strong>$R:</strong> Real payout /<br>  
<strong>L?:</strong> Days left until inactive / <strong>I?:</strong> Days since inactive / <strong>AA L3:</strong> All active ID-s on L3
</div>

<div class="frame" style="z-index:+1">
<iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRSSzQsM6izXxxxQNCQCXCnbWwQLid-GFLZSel39SnElJo6ZwK1fywqBE9Y7IukwcxVsmNlEvDETrwQ/pubhtml?gid=1414948812&amp;single=true&amp;widget=true&amp;headers=false&rm=minimal"
style="height:54px; width:800px">
</iframe>
</div>

<div style="display: flex; justify-content: center; width: 830px; margin: auto;">

  <div style="width: 800px">
    <iframe src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRSSzQsM6izXxxxQNCQCXCnbWwQLid-GFLZSel39SnElJo6ZwK1fywqBE9Y7IukwcxVsmNlEvDETrwQ/pubhtml?gid=696965585&range=A3:T1000&single=true&widget=true&headers=false&rm=minimal"
      style="position:relative; top: -62px; margin-left:-5px; height: 499px; width: 100%">
    </iframe>
  </div>

  <div id="buttonColumn" style="display: flex; flex-direction: column; width: 30px; align-items: center"></div>

</div>

<script>
  const scriptURL = "https://script.google.com/macros/s/AKfycbxGrVdox0yivm6h3D_G_GZNK16sJ9o0TvT0Pk8aSqOdU_Kn9cAAsyHwrVxkL94799_N/exec";

  async function loadIDButtons() {
    const res = await fetch(`${scriptURL}?mode=ids`);
    const ids = await res.json();
    const buttonColumn = document.getElementById('buttonColumn');

    ids.forEach(entry => {
      const link = document.createElement('a');
      link.href = '#';
      link.title = entry.id;
      link.textContent = 'ðŸ”²';
      link.style.display = 'block';
      link.style.margin = '2px';
      link.style.textDecoration = 'none';
      link.onclick = () => showRow(entry.row);
      buttonColumn.appendChild(link);
    });
  }

function showRow(row) {
  fetch(`${scriptURL}?row=${row}`)
    .then(response => response.text())
    .then(html => {
      document.getElementById('outputBox').innerHTML = html;
    })
    .catch(error => {
      document.getElementById('outputBox').innerHTML = `<div style="color:red;">Error loading row ${row}</div>`;
      console.error(error);
    });
}

   loadIDButtons();
</script>

<div id="outputBox" style="width: 830px; margin: 10px auto; border: 1px solid #ccc; padding: 10px; min-height: 100px">
  <!-- Output from the clicked row will appear here -->
</div>


<div class="legend2">
Some text is here!
</div>

</body>
</html>                           
